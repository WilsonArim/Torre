# Makefile do Orquestrador da TORRE

# Caminhos
TORRE_DIR := ..
ORQUESTRADOR_DIR := .
REPO_ROOT := ../..
CORE_ORQUESTRADOR := $(REPO_ROOT)/core/orquestrador

.PHONY: treino pipeline_validate sop gatekeeper_run executa status

# Executa treino de uma fase
treino:
	@echo "ğŸš€ Executando treino..."
	@echo "Uso: make treino PHASE=fase0|fase1|fase2|fase3|fase4|fase5"
	@if [ -z "$(PHASE)" ]; then \
		echo "âŒ ERRO: Especifique PHASE (fase0 a fase5)"; \
		exit 1; \
	fi
	@python3 cli.py treino $(PHASE)

# Valida pipeline
pipeline_validate:
	@echo "ğŸ” Validando pipeline..."
	@python3 cli.py pipeline_validate

# Executa validaÃ§Ã£o SOP
sop:
	@echo "ğŸ“‹ Executando validaÃ§Ã£o SOP..."
	@python3 cli.py sop

# Executa Gatekeeper
gatekeeper_run:
	@echo "ğŸ” Executando Gatekeeper..."
	@python3 cli.py gatekeeper_run

# Executa ordem do Estado-Maior (ciclo completo v1.0)
executa:
	@echo "ğŸ“‹ Executando ordem do Estado-Maior..."
	@python3 engineer_executor.py executa

# Mostra status
status:
	@echo "ğŸ“Š Status da TORRE..."
	@python3 cli.py status

# Quem age (roteador de direÃ§Ã£o)
who:
	@python3 cli.py who_acts "$(task)" $(if $(gate),--gate $(gate),)

# Help
help:
	@echo "ğŸ“š Comandos disponÃ­veis do Orquestrador da TORRE:"
	@echo ""
	@echo "  make treino PHASE=fase0|fase1|fase2|fase3|fase4|fase5"
	@echo "  make pipeline_validate"
	@echo "  make sop"
	@echo "  make gatekeeper_run"
	@echo "  make executa"
	@echo "  make status"
	@echo "  make who task=\"<descriÃ§Ã£o>\" [gate=Gx]  # Verificar ownership"
	@echo ""
	@echo "ğŸ“– Ver torre/curriculum/PLAN.md para detalhes do plano de treino"
	@echo "ğŸ“– Ver PIN.md e PIN_ESTADO_MAIOR.md para regras de ownership"

